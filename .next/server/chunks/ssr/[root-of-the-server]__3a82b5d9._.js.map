{"version":3,"sources":["../../../../src/lib/products.ts","../../../../src/app/admin/products/AdminProductForm.tsx/__nextjs-internal-proxy.mjs","../../../../src/app/admin/products/ProductRow.tsx/__nextjs-internal-proxy.mjs","../../../../src/app/admin/products/page.tsx"],"sourcesContent":["import { promises as fs } from \"fs\";\nimport path from \"path\";\n\nexport type Product = {\n  id: string;\n  name: string;\n  description: string;\n  category: string;\n  imageUrl?: string;\n  createdAt: string;\n};\n\nconst DATA_DIR = path.join(process.cwd(), \"data\");\nconst PRODUCTS_FILE = path.join(DATA_DIR, \"products.json\");\n\nasync function ensureDataDir() {\n  await fs.mkdir(DATA_DIR, { recursive: true });\n}\n\nasync function readProducts(): Promise<Product[]> {\n  try {\n    await ensureDataDir();\n    const data = await fs.readFile(PRODUCTS_FILE, \"utf-8\");\n    return JSON.parse(data);\n  } catch {\n    return [];\n  }\n}\n\nexport async function getProducts(): Promise<Product[]> {\n  const products = await readProducts();\n  return products.sort(\n    (a, b) =>\n      new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n  );\n}\n\nexport async function addProduct(\n  product: Omit<Product, \"id\" | \"createdAt\">\n): Promise<Product> {\n  const { v4: uuid } = await import(\"uuid\");\n  const products = await readProducts();\n  const newProduct: Product = {\n    ...product,\n    id: uuid(),\n    createdAt: new Date().toISOString(),\n  };\n  products.push(newProduct);\n  await ensureDataDir();\n  await fs.writeFile(PRODUCTS_FILE, JSON.stringify(products, null, 2));\n  return newProduct;\n}\n\nexport async function deleteProduct(id: string): Promise<boolean> {\n  const products = await readProducts();\n  const filtered = products.filter((p) => p.id !== id);\n  if (filtered.length === products.length) return false;\n  await ensureDataDir();\n  await fs.writeFile(PRODUCTS_FILE, JSON.stringify(filtered, null, 2));\n  return true;\n}\n\nexport async function updateProduct(\n  id: string,\n  updates: Partial<Omit<Product, \"id\" | \"createdAt\">>\n): Promise<Product | null> {\n  const products = await readProducts();\n  const idx = products.findIndex((p) => p.id === id);\n  if (idx === -1) return null;\n  const current = products[idx];\n  products[idx] = {\n    ...current,\n    ...(updates.name !== undefined && { name: String(updates.name).trim() }),\n    ...(updates.description !== undefined && {\n      description: String(updates.description).trim(),\n    }),\n    ...(updates.category !== undefined && {\n      category: String(updates.category).trim(),\n    }),\n    ...(updates.imageUrl !== undefined && {\n      imageUrl: updates.imageUrl ? String(updates.imageUrl).trim() : undefined,\n    }),\n  };\n  await ensureDataDir();\n  await fs.writeFile(PRODUCTS_FILE, JSON.stringify(products, null, 2));\n  return products[idx];\n}\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/admin/products/AdminProductForm.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/admin/products/AdminProductForm.tsx\",\n    \"default\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/admin/products/ProductRow.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/admin/products/ProductRow.tsx\",\n    \"default\",\n);\n","import { getProducts } from \"@/lib/products\";\nimport AdminProductForm from \"./AdminProductForm\";\nimport ProductRow from \"./ProductRow\";\n\nexport default async function AdminProductsPage() {\n  const products = await getProducts();\n\n  return (\n    <div>\n      <h1 className=\"text-3xl font-bold text-white\">Products</h1>\n      <p className=\"mt-2 text-slate-400\">\n        Add new products or edit and manage existing ones.\n      </p>\n\n      <div className=\"mt-8 rounded-2xl border border-slate-700/50 bg-slate-800/30 p-6 sm:p-8\">\n        <h2 className=\"text-xl font-semibold text-white\">Add new product</h2>\n        <AdminProductForm />\n      </div>\n\n      <div className=\"mt-12\">\n        <h2 className=\"text-xl font-semibold text-white\">Existing products</h2>\n        {products.length === 0 ? (\n          <p className=\"mt-4 text-slate-400\">No products yet. Add one above.</p>\n        ) : (\n          <ul className=\"mt-4 space-y-4\">\n            {products.map((p) => (\n              <ProductRow key={p.id} product={p} />\n            ))}\n          </ul>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"sZAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAWA,IAAM,EAAW,EAAA,OAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,GAAI,QACpC,EAAgB,EAAA,OAAI,CAAC,IAAI,CAAC,EAAU,iBAE1C,eAAe,IACb,MAAM,EAAA,QAAE,CAAC,KAAK,CAAC,EAAU,CAAE,WAAW,CAAK,EAC7C,CAEA,eAAe,IACb,GAAI,CACF,MAAM,IACN,IAAM,EAAO,MAAM,EAAA,QAAE,CAAC,QAAQ,CAAC,EAAe,SAC9C,OAAO,KAAK,KAAK,CAAC,EACpB,CAAE,KAAM,CACN,MAAO,EAAE,AACX,CACF,CAEO,eAAe,IAEpB,MAAO,CADU,MAAM,GAAA,EACP,IAAI,CAClB,CAAC,EAAG,IACF,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,GAAK,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,GAErE,iFCjCe,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,6SAA+S,EAC5U,4EACA,gEAHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,yRAA2R,EACxT,wDACA,2HCHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,uSAAyS,EACtU,sEACA,gEAHW,CAAA,EAAA,AADf,EAAA,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,mRAAqR,EAClT,kDACA,8GCLJ,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEe,eAAe,IAC5B,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,IAElC,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,yCAAgC,aAC9C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,+BAAsB,uDAInC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mFACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,4CAAmC,oBACjD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAgB,CAAA,CAAA,MAGnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,4CAAmC,sBAC5B,IAApB,EAAS,MAAM,CACd,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,+BAAsB,oCAEnC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,0BACX,EAAS,GAAG,CAAE,AAAD,GACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAU,CAAA,CAAY,QAAS,GAAf,EAAE,EAAE,UAOnC","ignoreList":[1,2]}