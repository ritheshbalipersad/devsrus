(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[575],{1126:(e,t,a)=>{Promise.resolve().then(a.bind(a,8094)),Promise.resolve().then(a.bind(a,6261))},3321:(e,t,a)=>{"use strict";var s=a(4645);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},5030:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var s=a(5155),r=a(2115);function l({value:e,onChange:t,id:a="imageUrl"}){let[l,n]=(0,r.useState)(!1),[i,o]=(0,r.useState)(""),d=(0,r.useRef)(null);async function c(e){let a=e.target.files?.[0];if(a){o(""),n(!0);try{let e=new FormData;e.set("file",a);let s=await fetch("/api/admin/upload",{method:"POST",body:e}),r=await s.json().catch(()=>({}));if(!s.ok)return void o(r.error||"Upload failed");r.url&&t(r.url)}catch{o("Upload failed")}finally{n(!1),e.target.value=""}}}return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:a,className:"block text-sm font-medium text-slate-300",children:"Image URL or upload"}),(0,s.jsx)("input",{id:a,type:"text",value:e,onChange:e=>{o(""),t(e.target.value)},className:"w-full rounded-lg border border-slate-600 bg-slate-800 px-4 py-2 text-white placeholder-slate-500 focus:border-cyan-500 focus:outline-none focus:ring-1 focus:ring-cyan-500",placeholder:"https://... or upload below"}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsx)("input",{ref:d,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:c,disabled:l,className:"hidden","aria-label":"Upload image"}),(0,s.jsx)("button",{type:"button",onClick:()=>d.current?.click(),disabled:l,className:"rounded-lg border border-slate-600 bg-slate-700 px-4 py-2 text-sm text-slate-200 transition hover:bg-slate-600 disabled:opacity-50",children:l?"Uploading...":"Upload image"}),e&&(0,s.jsxs)("span",{className:"text-xs text-slate-500",children:["Current: ",e.startsWith("/")?e:"external URL"]})]}),i&&(0,s.jsx)("p",{className:"text-sm text-red-400",role:"alert",children:i})]})}},6261:(e,t,a)=>{"use strict";a.d(t,{default:()=>o});var s=a(5155),r=a(2115),l=a(3321);function n({productId:e,productName:t}){let a=(0,l.useRouter)(),[n,i]=(0,r.useState)(!1);async function o(){if(confirm(`Delete "${t}"?`)){i(!0);try{(await fetch(`/api/admin/products?id=${e}`,{method:"DELETE"})).ok&&a.refresh()}finally{i(!1)}}}return(0,s.jsx)("button",{type:"button",onClick:o,disabled:n,className:"shrink-0 rounded-lg border border-red-500/50 bg-red-500/10 px-4 py-2 text-sm font-medium text-red-400 transition hover:bg-red-500/20 disabled:opacity-50",children:n?"Deleting...":"Delete"})}var i=a(5030);function o({product:e}){let t=(0,l.useRouter)(),[a,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)("idle"),[u,m]=(0,r.useState)({name:e.name,description:e.description,category:e.category,imageUrl:e.imageUrl??""});async function g(a){a.preventDefault(),c("saving");try{let a=await fetch("/api/admin/products",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,name:u.name,description:u.description,category:u.category,imageUrl:u.imageUrl||void 0})});if(!a.ok){await a.json().catch(()=>({})),c("error");return}c("success"),o(!1),t.refresh()}catch{c("error")}}return a?(0,s.jsx)("li",{className:"rounded-xl border border-slate-600 bg-slate-800/80 p-4",children:(0,s.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300",children:"Name *"}),(0,s.jsx)("input",{type:"text",required:!0,value:u.name,onChange:e=>m(t=>({...t,name:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-600 bg-slate-800 px-4 py-2 text-white focus:border-cyan-500 focus:outline-none focus:ring-1 focus:ring-cyan-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300",children:"Category"}),(0,s.jsx)("input",{type:"text",value:u.category,onChange:e=>m(t=>({...t,category:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-600 bg-slate-800 px-4 py-2 text-white focus:border-cyan-500 focus:outline-none focus:ring-1 focus:ring-cyan-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300",children:"Description *"}),(0,s.jsx)("textarea",{required:!0,rows:3,value:u.description,onChange:e=>m(t=>({...t,description:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-600 bg-slate-800 px-4 py-2 text-white focus:border-cyan-500 focus:outline-none focus:ring-1 focus:ring-cyan-500"})]}),(0,s.jsx)("div",{children:(0,s.jsx)(i.A,{id:`image-${e.id}`,value:u.imageUrl,onChange:e=>m(t=>({...t,imageUrl:e}))})}),"error"===d&&(0,s.jsx)("p",{className:"text-sm text-red-400",children:"Failed to save. Try again."}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("button",{type:"submit",disabled:"saving"===d,className:"rounded-lg bg-cyan-500 px-4 py-2 text-sm font-semibold text-slate-900 transition hover:bg-cyan-400 disabled:opacity-50",children:"saving"===d?"Saving...":"Save"}),(0,s.jsx)("button",{type:"button",onClick:function(){m({name:e.name,description:e.description,category:e.category,imageUrl:e.imageUrl??""}),o(!1),c("idle")},disabled:"saving"===d,className:"rounded-lg border border-slate-600 px-4 py-2 text-sm text-slate-300 transition hover:bg-slate-700 disabled:opacity-50",children:"Cancel"})]})]})}):(0,s.jsxs)("li",{className:"flex flex-col gap-4 rounded-xl border border-slate-700/50 bg-slate-800/50 p-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("span",{className:"text-sm text-cyan-400",children:e.category}),(0,s.jsx)("h3",{className:"font-semibold text-white",children:e.name}),(0,s.jsx)("p",{className:"mt-1 truncate text-sm text-slate-400",children:e.description})]}),(0,s.jsxs)("div",{className:"flex shrink-0 gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>o(!0),className:"rounded-lg border border-slate-600 bg-slate-700 px-4 py-2 text-sm font-medium text-white transition hover:bg-slate-600",children:"Edit"}),(0,s.jsx)(n,{productId:e.id,productName:e.name})]})]})}},8094:(e,t,a)=>{"use strict";a.d(t,{default:()=>i});var s=a(5155),r=a(2115),l=a(3321),n=a(5030);function i(){let e=(0,l.useRouter)(),[t,a]=(0,r.useState)("idle"),[i,o]=(0,r.useState)({name:"",description:"",category:"Software",imageUrl:""});async function d(t){t.preventDefault(),a("sending");try{if(!(await fetch("/api/admin/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...i,imageUrl:i.imageUrl||void 0})})).ok)throw Error("Failed to add");a("success"),o({name:"",description:"",category:"Software",imageUrl:""}),e.refresh()}catch{a("error")}}return(0,s.jsxs)("form",{onSubmit:d,className:"mt-6 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-300",children:"Name *"}),(0,s.jsx)("input",{id:"name",type:"text",required:!0,value:i.name,onChange:e=>o(t=>({...t,name:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-600 bg-slate-800 px-4 py-2 text-white focus:border-cyan-500 focus:outline-none focus:ring-1 focus:ring-cyan-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-slate-300",children:"Category"}),(0,s.jsx)("input",{id:"category",type:"text",value:i.category,onChange:e=>o(t=>({...t,category:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-600 bg-slate-800 px-4 py-2 text-white focus:border-cyan-500 focus:outline-none focus:ring-1 focus:ring-cyan-500",placeholder:"e.g. Software, App, Tool"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-300",children:"Description *"}),(0,s.jsx)("textarea",{id:"description",required:!0,rows:3,value:i.description,onChange:e=>o(t=>({...t,description:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-600 bg-slate-800 px-4 py-2 text-white focus:border-cyan-500 focus:outline-none focus:ring-1 focus:ring-cyan-500"})]}),(0,s.jsx)("div",{children:(0,s.jsx)(n.A,{id:"imageUrl",value:i.imageUrl,onChange:e=>o(t=>({...t,imageUrl:e}))})}),"success"===t&&(0,s.jsx)("p",{className:"text-emerald-400",children:"Product added successfully."}),"error"===t&&(0,s.jsx)("p",{className:"text-red-400",children:"Failed to add product. Please try again."}),(0,s.jsx)("button",{type:"submit",disabled:"sending"===t,className:"rounded-lg bg-cyan-500 px-6 py-2 font-semibold text-slate-900 transition hover:bg-cyan-400 disabled:opacity-50",children:"sending"===t?"Adding...":"Add product"})]})}}},e=>{e.O(0,[441,794,358],()=>e(e.s=1126)),_N_E=e.O()}]);