{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Source/Repos/devsrus/src/lib/products.ts"],"sourcesContent":["import { promises as fs } from \"fs\";\nimport path from \"path\";\n\nexport type Product = {\n  id: string;\n  name: string;\n  description: string;\n  category: string;\n  imageUrl?: string;\n  createdAt: string;\n};\n\nconst DATA_DIR = path.join(process.cwd(), \"data\");\nconst PRODUCTS_FILE = path.join(DATA_DIR, \"products.json\");\n\nasync function ensureDataDir() {\n  await fs.mkdir(DATA_DIR, { recursive: true });\n}\n\nasync function readProducts(): Promise<Product[]> {\n  try {\n    await ensureDataDir();\n    const data = await fs.readFile(PRODUCTS_FILE, \"utf-8\");\n    return JSON.parse(data);\n  } catch {\n    return [];\n  }\n}\n\nexport async function getProducts(): Promise<Product[]> {\n  const products = await readProducts();\n  return products.sort(\n    (a, b) =>\n      new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n  );\n}\n\nexport async function addProduct(\n  product: Omit<Product, \"id\" | \"createdAt\">\n): Promise<Product> {\n  const { v4: uuid } = await import(\"uuid\");\n  const products = await readProducts();\n  const newProduct: Product = {\n    ...product,\n    id: uuid(),\n    createdAt: new Date().toISOString(),\n  };\n  products.push(newProduct);\n  await ensureDataDir();\n  await fs.writeFile(PRODUCTS_FILE, JSON.stringify(products, null, 2));\n  return newProduct;\n}\n\nexport async function deleteProduct(id: string): Promise<boolean> {\n  const products = await readProducts();\n  const filtered = products.filter((p) => p.id !== id);\n  if (filtered.length === products.length) return false;\n  await ensureDataDir();\n  await fs.writeFile(PRODUCTS_FILE, JSON.stringify(filtered, null, 2));\n  return true;\n}\n\nexport async function updateProduct(\n  id: string,\n  updates: Partial<Omit<Product, \"id\" | \"createdAt\">>\n): Promise<Product | null> {\n  const products = await readProducts();\n  const idx = products.findIndex((p) => p.id === id);\n  if (idx === -1) return null;\n  const current = products[idx];\n  products[idx] = {\n    ...current,\n    ...(updates.name !== undefined && { name: String(updates.name).trim() }),\n    ...(updates.description !== undefined && {\n      description: String(updates.description).trim(),\n    }),\n    ...(updates.category !== undefined && {\n      category: String(updates.category).trim(),\n    }),\n    ...(updates.imageUrl !== undefined && {\n      imageUrl: updates.imageUrl ? String(updates.imageUrl).trim() : undefined,\n    }),\n  };\n  await ensureDataDir();\n  await fs.writeFile(PRODUCTS_FILE, JSON.stringify(products, null, 2));\n  return products[idx];\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAWA,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AAC1C,MAAM,gBAAgB,4GAAI,CAAC,IAAI,CAAC,UAAU;AAE1C,eAAe;IACb,MAAM,yGAAE,CAAC,KAAK,CAAC,UAAU;QAAE,WAAW;IAAK;AAC7C;AAEA,eAAe;IACb,IAAI;QACF,MAAM;QACN,MAAM,OAAO,MAAM,yGAAE,CAAC,QAAQ,CAAC,eAAe;QAC9C,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAM;QACN,OAAO,EAAE;IACX;AACF;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM;IACvB,OAAO,SAAS,IAAI,CAClB,CAAC,GAAG,IACF,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO;AAErE;AAEO,eAAe,WACpB,OAA0C;IAE1C,MAAM,EAAE,IAAI,IAAI,EAAE,GAAG;IACrB,MAAM,WAAW,MAAM;IACvB,MAAM,aAAsB;QAC1B,GAAG,OAAO;QACV,IAAI;QACJ,WAAW,IAAI,OAAO,WAAW;IACnC;IACA,SAAS,IAAI,CAAC;IACd,MAAM;IACN,MAAM,yGAAE,CAAC,SAAS,CAAC,eAAe,KAAK,SAAS,CAAC,UAAU,MAAM;IACjE,OAAO;AACT;AAEO,eAAe,cAAc,EAAU;IAC5C,MAAM,WAAW,MAAM;IACvB,MAAM,WAAW,SAAS,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IACjD,IAAI,SAAS,MAAM,KAAK,SAAS,MAAM,EAAE,OAAO;IAChD,MAAM;IACN,MAAM,yGAAE,CAAC,SAAS,CAAC,eAAe,KAAK,SAAS,CAAC,UAAU,MAAM;IACjE,OAAO;AACT;AAEO,eAAe,cACpB,EAAU,EACV,OAAmD;IAEnD,MAAM,WAAW,MAAM;IACvB,MAAM,MAAM,SAAS,SAAS,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAC/C,IAAI,QAAQ,CAAC,GAAG,OAAO;IACvB,MAAM,UAAU,QAAQ,CAAC,IAAI;IAC7B,QAAQ,CAAC,IAAI,GAAG;QACd,GAAG,OAAO;QACV,GAAI,QAAQ,IAAI,KAAK,aAAa;YAAE,MAAM,OAAO,QAAQ,IAAI,EAAE,IAAI;QAAG,CAAC;QACvE,GAAI,QAAQ,WAAW,KAAK,aAAa;YACvC,aAAa,OAAO,QAAQ,WAAW,EAAE,IAAI;QAC/C,CAAC;QACD,GAAI,QAAQ,QAAQ,KAAK,aAAa;YACpC,UAAU,OAAO,QAAQ,QAAQ,EAAE,IAAI;QACzC,CAAC;QACD,GAAI,QAAQ,QAAQ,KAAK,aAAa;YACpC,UAAU,QAAQ,QAAQ,GAAG,OAAO,QAAQ,QAAQ,EAAE,IAAI,KAAK;QACjE,CAAC;IACH;IACA,MAAM;IACN,MAAM,yGAAE,CAAC,SAAS,CAAC,eAAe,KAAK,SAAS,CAAC,UAAU,MAAM;IACjE,OAAO,QAAQ,CAAC,IAAI;AACtB"}},
    {"offset": {"line": 141, "column": 0}, "map": {"version":3,"sources":["file:///C:/Source/Repos/devsrus/src/app/api/admin/products/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { addProduct, deleteProduct, updateProduct } from \"@/lib/products\";\n\nexport async function POST(req: NextRequest) {\n  try {\n    const body = await req.json();\n    const { name, description, category, imageUrl } = body;\n\n    if (!name || !description) {\n      return NextResponse.json(\n        { error: \"Name and description are required\" },\n        { status: 400 }\n      );\n    }\n\n    const product = await addProduct({\n      name: String(name).trim(),\n      description: String(description).trim(),\n      category: String(category || \"Software\").trim(),\n      imageUrl: imageUrl ? String(imageUrl).trim() : undefined,\n    });\n\n    return NextResponse.json(product);\n  } catch (err) {\n    console.error(\"Add product error:\", err);\n    return NextResponse.json(\n      { error: \"Failed to add product\" },\n      { status: 500 }\n    );\n  }\n}\n\nexport async function PATCH(req: NextRequest) {\n  try {\n    const body = await req.json();\n    const { id, name, description, category, imageUrl } = body;\n\n    if (!id) {\n      return NextResponse.json(\n        { error: \"Product ID required\" },\n        { status: 400 }\n      );\n    }\n\n    const updates: Partial<{ name: string; description: string; category: string; imageUrl?: string }> = {};\n    if (name !== undefined) updates.name = String(name).trim();\n    if (description !== undefined) updates.description = String(description).trim();\n    if (category !== undefined) updates.category = String(category).trim();\n    if (imageUrl !== undefined) updates.imageUrl = imageUrl ? String(imageUrl).trim() : undefined;\n\n    if (Object.keys(updates).length === 0) {\n      return NextResponse.json(\n        { error: \"At least one field to update is required\" },\n        { status: 400 }\n      );\n    }\n\n    const product = await updateProduct(String(id), updates);\n    if (!product) {\n      return NextResponse.json({ error: \"Product not found\" }, { status: 404 });\n    }\n    return NextResponse.json(product);\n  } catch (err) {\n    console.error(\"Update product error:\", err);\n    return NextResponse.json(\n      { error: \"Failed to update product\" },\n      { status: 500 }\n    );\n  }\n}\n\nexport async function DELETE(req: NextRequest) {\n  try {\n    const id = req.nextUrl.searchParams.get(\"id\");\n    if (!id) {\n      return NextResponse.json({ error: \"Product ID required\" }, { status: 400 });\n    }\n    const ok = await deleteProduct(id);\n    if (!ok) {\n      return NextResponse.json({ error: \"Product not found\" }, { status: 404 });\n    }\n    return NextResponse.json({ success: true });\n  } catch (err) {\n    console.error(\"Delete product error:\", err);\n    return NextResponse.json(\n      { error: \"Failed to delete product\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG;QAElD,IAAI,CAAC,QAAQ,CAAC,aAAa;YACzB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAoC,GAC7C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,UAAU,MAAM,IAAA,sIAAU,EAAC;YAC/B,MAAM,OAAO,MAAM,IAAI;YACvB,aAAa,OAAO,aAAa,IAAI;YACrC,UAAU,OAAO,YAAY,YAAY,IAAI;YAC7C,UAAU,WAAW,OAAO,UAAU,IAAI,KAAK;QACjD;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,MAAM,GAAgB;IAC1C,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,EAAE,EAAE,IAAI,EAAE,WAAW,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG;QAEtD,IAAI,CAAC,IAAI;YACP,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsB,GAC/B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,UAA+F,CAAC;QACtG,IAAI,SAAS,WAAW,QAAQ,IAAI,GAAG,OAAO,MAAM,IAAI;QACxD,IAAI,gBAAgB,WAAW,QAAQ,WAAW,GAAG,OAAO,aAAa,IAAI;QAC7E,IAAI,aAAa,WAAW,QAAQ,QAAQ,GAAG,OAAO,UAAU,IAAI;QACpE,IAAI,aAAa,WAAW,QAAQ,QAAQ,GAAG,WAAW,OAAO,UAAU,IAAI,KAAK;QAEpF,IAAI,OAAO,IAAI,CAAC,SAAS,MAAM,KAAK,GAAG;YACrC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA2C,GACpD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,UAAU,MAAM,IAAA,yIAAa,EAAC,OAAO,KAAK;QAChD,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAoB,GAAG;gBAAE,QAAQ;YAAI;QACzE;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA2B,GACpC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,OAAO,GAAgB;IAC3C,IAAI;QACF,MAAM,KAAK,IAAI,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QACxC,IAAI,CAAC,IAAI;YACP,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QACA,MAAM,KAAK,MAAM,IAAA,yIAAa,EAAC;QAC/B,IAAI,CAAC,IAAI;YACP,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAoB,GAAG;gBAAE,QAAQ;YAAI;QACzE;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA2B,GACpC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}