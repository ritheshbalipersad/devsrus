{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Source/Repos/devsrus/src/lib/auth.ts"],"sourcesContent":["import { createHmac } from \"crypto\";\n\nconst COOKIE_NAME = \"admin_session\";\nconst SESSION_HOURS = 24;\n\n/** Create a signed session cookie value (use in Node/API route only). */\nexport function createSessionCookie(secret: string): string {\n  const expiry = String(Date.now() + SESSION_HOURS * 60 * 60 * 1000);\n  const signature = createHmac(\"sha256\", secret)\n    .update(expiry)\n    .digest(\"base64url\");\n  return `${expiry}.${signature}`;\n}\n\nexport function getAdminCredentials() {\n  const password = process.env.SMTP_PASS;\n  return { username: \"admin\", password: password ?? \"\" };\n}\n\nexport function isAdminLogin(username: string, password: string): boolean {\n  const { username: expectedUser, password: expectedPass } =\n    getAdminCredentials();\n  return (\n    expectedPass.length > 0 &&\n    username === expectedUser &&\n    password === expectedPass\n  );\n}\n\nexport { COOKIE_NAME };\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEA,MAAM,cAAc;AACpB,MAAM,gBAAgB;AAGf,SAAS,oBAAoB,MAAc;IAChD,MAAM,SAAS,OAAO,KAAK,GAAG,KAAK,gBAAgB,KAAK,KAAK;IAC7D,MAAM,YAAY,IAAA,mHAAU,EAAC,UAAU,QACpC,MAAM,CAAC,QACP,MAAM,CAAC;IACV,OAAO,GAAG,OAAO,CAAC,EAAE,WAAW;AACjC;AAEO,SAAS;IACd,MAAM,WAAW,QAAQ,GAAG,CAAC,SAAS;IACtC,OAAO;QAAE,UAAU;QAAS,UAAU,YAAY;IAAG;AACvD;AAEO,SAAS,aAAa,QAAgB,EAAE,QAAgB;IAC7D,MAAM,EAAE,UAAU,YAAY,EAAE,UAAU,YAAY,EAAE,GACtD;IACF,OACE,aAAa,MAAM,GAAG,KACtB,aAAa,gBACb,aAAa;AAEjB"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///C:/Source/Repos/devsrus/src/app/api/auth/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport {\n  isAdminLogin,\n  createSessionCookie,\n  COOKIE_NAME,\n} from \"@/lib/auth\";\n\nconst SESSION_HOURS = 24;\n\nexport async function POST(req: NextRequest) {\n  try {\n    const body = await req.json();\n    const username = String(body.username ?? \"\").trim();\n    const password = String(body.password ?? \"\");\n\n    if (!username || !password) {\n      return NextResponse.json(\n        { error: \"Username and password are required\" },\n        { status: 400 }\n      );\n    }\n\n    if (!isAdminLogin(username, password)) {\n      return NextResponse.json(\n        { error: \"Invalid username or password\" },\n        { status: 401 }\n      );\n    }\n\n    const secret = process.env.SMTP_PASS;\n    if (!secret) {\n      return NextResponse.json(\n        { error: \"Server auth not configured (SMTP_PASS)\" },\n        { status: 500 }\n      );\n    }\n\n    const value = createSessionCookie(secret);\n    const res = NextResponse.json({\n      success: true,\n      redirectTo: \"/admin\",\n    });\n    res.cookies.set(COOKIE_NAME, value, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      sameSite: \"lax\",\n      maxAge: SESSION_HOURS * 60 * 60,\n      path: \"/\",\n    });\n\n    return res;\n  } catch (err) {\n    console.error(\"Login error:\", err);\n    return NextResponse.json(\n      { error: \"Login failed\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAMA,MAAM,gBAAgB;AAEf,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,WAAW,OAAO,KAAK,QAAQ,IAAI,IAAI,IAAI;QACjD,MAAM,WAAW,OAAO,KAAK,QAAQ,IAAI;QAEzC,IAAI,CAAC,YAAY,CAAC,UAAU;YAC1B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAqC,GAC9C;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,CAAC,IAAA,oIAAY,EAAC,UAAU,WAAW;YACrC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA+B,GACxC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS,QAAQ,GAAG,CAAC,SAAS;QACpC,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAyC,GAClD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,IAAA,2IAAmB,EAAC;QAClC,MAAM,MAAM,gJAAY,CAAC,IAAI,CAAC;YAC5B,SAAS;YACT,YAAY;QACd;QACA,IAAI,OAAO,CAAC,GAAG,CAAC,mIAAW,EAAE,OAAO;YAClC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,gBAAgB,KAAK;YAC7B,MAAM;QACR;QAEA,OAAO;IACT,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAe,GACxB;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}